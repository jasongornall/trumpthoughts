// Generated by CoffeeScript 1.8.0
var config, msnry;

msnry = null;

config = {
  apiKey: "AIzaSyBmPkme_3537O_YbLRlq27PiFMOtNi4vP4",
  authDomain: "trump-64059.firebaseapp.com",
  databaseURL: "https://trump-64059.firebaseio.com",
  storageBucket: "trump-64059.appspot.com",
  messagingSenderId: "57700495171"
};

firebase.initializeApp(config);

$('trix-editor')[0].editor.setSelectedRange([100, 100]);

firebase.auth().onAuthStateChanged(function(user) {
  return $('body > #auth').html(teacup.render(function() {
    return div('.btn', function() {
      span(function() {
        return "logged in as: ";
      });
      img({
        src: user.photoURL
      });
      return span(function() {
        return " " + user.displayName;
      });
    });
  }));
});

$('#submit').on('click', function(obj) {
  $('body #popups').append(teacup.render(function() {
    return div('.modalDialog submit', function() {
      return div('.wrapper', function() {
        span('.close', function() {
          return 'x';
        });
        h3(function() {
          return 'Pick your submission type';
        });
        return div('.navigation', function() {
          span('.option', {
            'data-option': 'google'
          }, function() {
            img({
              src: 'https://www.gstatic.com/mobilesdk/160512_mobilesdk/auth_service_google.svg'
            });
            return span(function() {
              return 'Google';
            });
          });
          span('.option', {
            'data-option': 'facebook'
          }, function() {
            img({
              src: 'https://www.gstatic.com/mobilesdk/160409_mobilesdk/images/auth_service_facebook.svg'
            });
            return span(function() {
              return 'Facebook';
            });
          });
          return span('.option', {
            'data-option': 'twitter'
          }, function() {
            img({
              src: 'https://www.gstatic.com/mobilesdk/160409_mobilesdk/images/auth_service_twitter.svg'
            });
            return span(function() {
              return 'Twitter';
            });
          });
        });
      });
    });
  }));
  $('.modalDialog.submit').fadeIn();
  $('.modalDialog.submit .close').on('click', function(e) {
    var $el;
    return $el = $(e.currentTarget).closest('.modalDialog').fadeOut('slow', function() {
      return $(this).remove();
    });
  });
  return $('.modalDialog.submit [data-option]').on('click', function(e) {
    var $el, provider;
    $el = $(e.currentTarget);
    switch ($el.data('option')) {
      case 'google':
        provider = new firebase.auth.GoogleAuthProvider();
        return firebase.auth().signInWithPopup(provider).then(function(result) {
          var token, user;
          token = result.credential.accessToken;
          user = result.user;
          return finishLogin(token, user);
        })["catch"](function(error) {
          if (error) {
            return console.log(error);
          }
        });
    }
  });
});
